<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è¨‚è³¼ç³»çµ± - æˆæ¬Šè¼”åŠ©</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    html, body {
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: #f5f5f5;
      font-family: system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
    }

    /* é ‚éƒ¨æç¤ºæ¬„ */
    #auth-panel {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: #fff3cd;
      border-bottom: 2px solid #ffeeba;
      padding: 15px;
      z-index: 2000;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    #auth-panel.hidden {
      display: none;
    }
    .auth-title {
      font-weight: bold;
      color: #856404;
      font-size: 18px;
      margin-bottom: 5px;
    }
    .auth-link {
      background: white;
      padding: 12px;
      border-radius: 8px;
      border: 1px solid #ddd;
      word-break: break-all;
      font-size: 14px;
      color: #0066cc;
      text-decoration: underline;
    }
    .button-group {
      display: flex;
      gap: 10px;
      margin-top: 5px;
    }
    .btn {
      flex: 1;
      padding: 12px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      background: #4CAF50;
      color: white;
      transition: background 0.2s;
    }
    .btn.secondary {
      background: #6c757d;
    }
    .btn:hover {
      opacity: 0.9;
    }

    /* iframe å®¹å™¨ (ç•™å‡ºé ‚éƒ¨ç©ºé–“) */
    .iframe-container {
      width: 100%;
      height: 100%;
      padding-top: 170px; /* æ ¹æ“šé ‚éƒ¨é¢æ¿é«˜åº¦èª¿æ•´ */
    }
    iframe {
      width: 100%;
      height: 100%;
      border: none;
      display: block;
    }
  </style>
</head>
<body>
  <div id="auth-panel">
    <div class="auth-title">âš ï¸ éœ€è¦å®Œæˆ Google æˆæ¬Š</div>
    <div>è«‹é»æ“Šä¸‹æ–¹é€£çµï¼Œåœ¨æ–°é é¢ä¸­é»æ“Šã€Œå…è¨±ã€å®Œæˆæˆæ¬Šï¼Œç„¶å¾Œè¿”å›æ­¤é é»æ“Šã€Œå·²æˆæ¬Šï¼Œé‡æ–°è¼‰å…¥ã€ã€‚</div>
    <div class="auth-link" id="auth-link">https://script.google.com/...</div>
    <div class="button-group">
      <button class="btn" id="open-link-btn">ğŸ”— åœ¨æ–°åˆ†é é–‹å•Ÿé€£çµ</button>
      <button class="btn secondary" id="refresh-btn">ğŸ”„ å·²æˆæ¬Šï¼Œé‡æ–°è¼‰å…¥</button>
    </div>
    <div style="font-size:14px; color:#666; margin-top:5px;">è‹¥ç„¡æ³•è‡ªå‹•å½ˆçª—ï¼Œè«‹é•·æŒ‰é€£çµè¤‡è£½å¾Œæ‰‹å‹•è²¼åˆ°ç€è¦½å™¨ã€‚</div>
  </div>
  <div class="iframe-container">
    <iframe 
      id="main-iframe"
      src="https://script.google.com/macros/s/AKfycbwrr2k3iwyeh3Ueil7UsGTD-g9nQW24ELsSNuosyafm6jhxCV97ZSRmw6cbf8ckHDgw/exec?force=mobile"
      sandbox="allow-same-origin allow-scripts allow-popups allow-forms allow-modals allow-downloads"
      loading="lazy"
    ></iframe>
  </div>

  <script>
    const iframe = document.getElementById('main-iframe');
    const authPanel = document.getElementById('auth-panel');
    const authLinkDiv = document.getElementById('auth-link');
    const openBtn = document.getElementById('open-link-btn');
    const refreshBtn = document.getElementById('refresh-btn');

    // å¾ iframe çš„ src å–å¾—æˆæ¬Šé€£çµï¼ˆå³ç›¸åŒçš„ URLï¼Œä¸å¸¶ force ä¹Ÿå¯ï¼Œä½†ä¿ç•™ï¼‰
    const baseUrl = iframe.src;

    // é¡¯ç¤ºé€£çµ
    authLinkDiv.textContent = baseUrl;

    // åœ¨æ–°åˆ†é é–‹å•Ÿé€£çµ
    openBtn.addEventListener('click', () => {
      window.open(baseUrl, '_blank');
    });

    // é‡æ–°è¼‰å…¥ iframe
    refreshBtn.addEventListener('click', () => {
      iframe.src = baseUrl; // é‡æ–°è¼‰å…¥
      // å¯é¸ï¼šæš«æ™‚éš±è—é¢æ¿ï¼Œå¦‚æœè¼‰å…¥æˆåŠŸå¾Œé¢æ¿æ‡‰è‡ªå‹•éš±è—ï¼ˆä½†æˆ‘å€‘ä¸çŸ¥é“ä½•æ™‚æˆåŠŸï¼‰
      // ç°¡å–®èµ·è¦‹ï¼Œä¿ç•™é¢æ¿è®“ç”¨æˆ¶è‡ªè¡Œæ±ºå®š
    });

    // å¯é¸ï¼šå®šæœŸæª¢æŸ¥ iframe æ˜¯å¦å·²æˆæ¬Šï¼ˆç„¡æ³•ç›´æ¥æª¢æ¸¬ï¼Œä½†å¯ä»¥ç›£è½è¼‰å…¥äº‹ä»¶ï¼‰
    iframe.addEventListener('load', () => {
      // å˜—è©¦ç²å– iframe å…§éƒ¨æ–‡æª”ï¼Œå¦‚æœè·¨åŸŸå¯èƒ½å¤±æ•—ï¼Œä½†é€™è£¡æˆ‘å€‘å¯ä»¥å‡è¨­è¼‰å…¥æˆåŠŸå¯èƒ½å·²æˆæ¬Š
      console.log('iframe è¼‰å…¥äº‹ä»¶è§¸ç™¼');
      // å¦‚æœè¼‰å…¥æˆåŠŸï¼Œå¯ä»¥éš±è—é¢æ¿ï¼ˆä½†å¯èƒ½æ˜¯æˆæ¬Šé é¢æœ¬èº«ï¼‰
      // ç‚ºäº†ç°¡å–®ï¼Œä¿ç•™é¢æ¿
    });

    // ç›£è½ iframe å…§éƒ¨çš„æ¶ˆæ¯ï¼ˆå¦‚æœå¯èƒ½ï¼Œè·¨åŸŸé™åˆ¶ç„¡æ³•ç›´æ¥é€šä¿¡ï¼‰
    // å› æ­¤æˆ‘å€‘ä¾é ç”¨æˆ¶æ‰‹å‹•é»æ“Šåˆ·æ–°æŒ‰éˆ•

    console.log('æˆæ¬Šè¼”åŠ©é¢æ¿å·²è¼‰å…¥ã€‚è‹¥ iframe å…§éœ€è¦æˆæ¬Šï¼Œè«‹ä½¿ç”¨ä¸Šæ–¹æŒ‰éˆ•ã€‚');
  </script>
</body>
</html>
